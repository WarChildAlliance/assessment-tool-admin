<div class="main-board">
  <div class="main-board__top-container">

    <div class="main-board__top-container__actions">
      <app-custom-button icon="edit_outline" category="secondary" variant="primary" (click)="editCurrentStudent()">
        {{ "students.editStudent" | translate }}
      </app-custom-button>
<!--       <button mat-flat-button color="primary" (click)="deleteCurrentStudent()" [disabled]="true">
        <mat-icon>delete_outline</mat-icon> Delete student
      </button> -->
    </div>
  </div>

  <div class="main-board__details" *ngIf="student">
    <div class="main-board__details__element">
      <span class="title">{{ "general.name" | translate }}</span>
      <span class="value">{{ student.full_name }}</span>
    </div>
    <div class="main-board__details__element">
      <span class="title">
        {{ "students.studentDetail.numberAssessments" | translate }}
        </span>
      <span class="value">{{ student.assessments_count }}</span>
    </div>
    <div class="main-board__details__element">
      <span class="title">
        {{ "general.totalCompletedTopics" | translate }}
      </span>
      <span class="value">{{ student.completed_topics_count }}</span>
    </div>
    <div class="main-board__details__element">
      <span class="title">
        {{ "general.lastLogin" | translate }}
        </span>
      <span class="value">{{ student.last_session | date:'short' }}</span>
    </div>
    <div class="main-board__details__element">
      <span class="title">
        {{ "general.language" | translate }}
        </span>
      <span class="value">{{ student.language_name }}</span>
    </div>
    <div class="main-board__details__element">
      <span class="title">
        {{ "general.country" | translate }}
        </span>
      <span class="value">{{ student.country_name }}</span>
    </div>
  </div>

  <div class="main-board__accordions-container">
    <h3>
      {{ "students.studentDetail.studentAssessments" | translate }}
      </h3>
    <p *ngIf="!studentAssessments">{{ "students.studentDetail.studentNotLinkedAssessment" | translate }}
      </p>
    <mat-accordion multi>
      <mat-expansion-panel *ngFor="let assessment of studentAssessments">
        <mat-expansion-panel-header>
          <mat-panel-title>
            <div>
              <span class="assessment-title">{{ assessment.title }} </span>
              <span class="linked-topics">({{ assessment.topic_access.length }}
                {{ "students.studentDetail.linkedTopics" | translate }})
              </span>
            </div>
            <app-custom-button icon="event_available" category="tertiary" (click)="editTopicsAccesses(assessment)">
              {{ 'students.studentDetail.editTopicAccess' | translate }}
            </app-custom-button>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <div class="main-board__accordions-container__topic" *ngFor="let topic of assessment.topic_access">
          <div class="main-board__accordions-container__topic__infos">
            <p>{{ topic.topic_name }}</p>
          </div>
          <div class="main-board__accordions-container__topic__infos" *ngIf="topic.start_date">
            <p>{{ "general.from" | translate }} {{ topic.start_date }}
              {{ "general.to" | translate }} {{ topic.end_date }}</p>
          </div>
          <div class="main-board__accordions-container__topic__infos">
            <p *ngIf="topic.hasAccess">
              {{ "students.studentDetail.activeAccess" | translate }}
             </p>
              <p *ngIf="!topic.hasAccess">
                {{ "students.studentDetail.noActiveAccess" | translate }}
                 </p>
          </div>
        </div>
      </mat-expansion-panel>
    </mat-accordion>
  </div>

  <div class="main-board__tabs-container">
    <h3>
      {{ "students.studentDetail.assessmentsOverview" | translate }}
      </h3>
    <app-assessments-answers></app-assessments-answers>
  </div>
</div>

<ng-template #editAssignTopicDialog>
  <app-topic-access-edit [assessment]="[assessment]" [studentId]="student.id"></app-topic-access-edit>
</ng-template>