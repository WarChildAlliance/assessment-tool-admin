<mat-card  [ngClass]="{'assessment-container': assessment.archived == false, 'assessment-archived-container': assessment.archived == true}">
    <div class="assessment-details">
        <div class="general-information">
            <img *ngIf="assessment.icon" [src]="getSource(assessment.icon)">
            <span>{{ assessment.title }}</span>
        </div>
        <div class="details">
            <div class="infos">
                <p>Grade</p>
                <p>{{ assessment.grade }}</p>
            </div>
            <div class="infos">
                <p>Subject</p>
                <p>{{ assessment.subject }}</p>
            </div>
            <div class="infos">
                <p>Language</p>
                <p>{{ assessment.language_code }}</p>
            </div>
            <div class="infos">
                <p>Country</p>
                <p>{{ assessment.country_code }}</p>
            </div>
            <div class="infos">
                <p>Private</p>
                <p>{{ assessment.private }}</p>
            </div>
        </div>
        <div class="buttons">
            <button *ngIf="canEdit" mat-button color="accent" (click)="editAssessment(assessment)">Edit</button>
            <button *ngIf="canEdit" mat-button color="accent" (click)="archiveAssessment(assessment.id, assessment.archived ? false : true)">{{assessment.archived ? 'Unarchive' : 'Archive'}}</button>
            <!--
            <button mat-button color="secondary">Clone</button>
            <button *ngIf="canEdit" mat-button color="secondary" (click)="deleteAssessment(assessment.id)">Delete</button>
            -->
        </div>
    </div>
    <hr>
    <div class="topics">
        <mat-card class="add-topic" (click)="openCreateTopicDialog(assessment.id)" *ngIf="canEdit">
            <div class="add-topic-text">
                Add a topic <mat-icon>add</mat-icon>
            </div>
        </mat-card>
        <mat-card class="topic-card" *ngFor="let topic of assessment.topics">
            <img *ngIf="topic.icon" [src]="getMediaSource(topic.icon)">
            <span class="topic-title">{{ topic.title }}</span>
            <p class="small-description">{{ topic.description }}</p>
            <span class="question_count">({{ topic.questionsCount }} questions)</span>

            <div [ngSwitch]="topic.archived">
                <div class="topic-buttons" *ngSwitchCase="false">
                    <button mat-icon-button matTooltip="Archive Topic" (click)="archiveTopic(assessment.id, topic.id, true)"> 
                        <mat-icon>archive</mat-icon>
                    </button>
                    <button mat-icon-button (click)="goToTopicDetails(assessment.id, topic.id)"> 
                        Topic Details <mat-icon>navigate_next</mat-icon>
                    </button>
                </div>

                <div *ngSwitchCase="true">
                    <button mat-stroked-button (click)="archiveTopic(assessment.id, topic.id, false)"> 
                        Unarchive Topic
                    </button>
                </div>
            </div>
        </mat-card>
    </div>
</mat-card>

<ng-template #createAssessmentDialog>
    <app-assessment-form-dialog [assessment]="assessment" [edit]="edit"></app-assessment-form-dialog>
</ng-template>

<ng-template #createTopicDialog>
    <mat-dialog-content>
        <app-topic-form-dialog [assessmentId]="assessmentId"></app-topic-form-dialog>
    </mat-dialog-content>
</ng-template>