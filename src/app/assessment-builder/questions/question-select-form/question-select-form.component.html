<form [formGroup]="selectForm" (ngSubmit)="onSave()">
    <div class="form-container">
        <div class="select-details-container">
            <h2>Question</h2>
            <mat-form-field appearance="outline" class="form-group" color="accent">
                <mat-label for="title">Select</mat-label>
                <input matInput formControlName="question_type">
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-group" color="accent">
                <mat-label for="title">Title</mat-label>
                <input matInput formControlName="title">
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-group" color="accent">
                <mat-label>Identifier</mat-label>
                <input matInput formControlName="identifier">
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-group" color="accent">
                <mat-label for="order">Order</mat-label>
                <input matInput type="number" formControlName="order">
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-group" color="accent">
                <mat-label for="display">Display</mat-label>
                <mat-select formControlName="display">
                    <mat-option *ngFor="let type of ['GRID', 'VERTICAL', 'HORIZONTAL']" [value]="type">{{type}}
                    </mat-option>
                </mat-select>
            </mat-form-field>
            <br>
            <mat-checkbox formControlName="multiple">
                <mat-label for="multiple">Is multiple choice?</mat-label>
            </mat-checkbox>
        </div>

        <div class="attachments-container">
            <h2>Attachments</h2>
            <p>Add an image attachment</p>
            <button type="button" mat-flat-button color="primary" (click)="imageFileInput.click()">Choose
                File</button>
            <input hidden (change)="handleFileInput($event, 'IMAGE')" #imageFileInput type="file">
            <p>Add an audio attachment</p>
            <button type="button" mat-flat-button color="primary" (click)="audioFileInput.click()">Choose
                File</button>
            <input hidden (change)="handleFileInput($event, 'AUDIO')" #audioFileInput type="file">
        </div>


        <div class="options-container" formArrayName="options">
            <h2>Options</h2>
            <p>Add an option <mat-icon (click)="addOptions()">add</mat-icon>
            </p>
            <div class="option-form" *ngFor="let control of selectForm.controls.options['controls']; let i = index"
                [formGroupName]="i">
                <mat-form-field appearance="outline" class="form-group" color="accent">
                    <mat-label>Value</mat-label>
                    <input matInput formControlName="value">
                </mat-form-field>
                <br>
                <mat-checkbox formControlName="valid">
                    <mat-label>Is correct answer?</mat-label>
                </mat-checkbox>

                <div class="attachments-container">
                    <p>Add an image attachment</p>
                    <!--
                <input type="file"
                (change)="handleFileInputOptions($event, 'IMAGE', i)">
                -->
                    <button type="button" mat-flat-button color="primary" (click)="imageFileInput.click()">Choose
                        File</button>
                    <input hidden (change)="handleFileInputOptions($event, 'IMAGE', i)" #imageFileInput type="file">
                    <p *ngIf="optionsAttachmentEdit.length &&  optionsAttachmentEdit[i].image"> {{
                        optionsAttachmentEdit[i].image }}</p>
                    <p>Add an audio attachment</p>
                    <button type="button" mat-flat-button color="primary" (click)="audioFileInput.click()">Choose
                        File</button>
                    <input hidden (change)="handleFileInputOptions($event, 'AUDIO', i)" #audioFileInput type="file">
                    <p *ngIf="optionsAttachmentEdit.length && optionsAttachmentEdit[i].audio"> {{
                        optionsAttachmentEdit[i].audio }}</p>
                </div>
                <button mat-flat-button type="button" class="submit-form-button" color="primary" 
                    (click)="saveOption(i)">
                    Save option
                </button>
            </div>
        </div>
    </div>
    <button class="question-form-button" mat-flat-button color="accent" type="submit" [disabled]="selectForm.invalid">
        Save
    </button>
</form>