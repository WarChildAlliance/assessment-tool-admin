<!DOCTYPE html>
<html>
    <head>
        <title>Gobee : Download to PDF</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Gobee</a></span>
                            </li>
                                                    <li>
                                <span><a href="Gobee-Home_65612.html">Gobee Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="GOBEE-Documentation_131073.html">GOBEE Documentation</a></span>
                            </li>
                                                    <li>
                                <span><a href="Technical-documentation_4685825.html">Technical documentation</a></span>
                            </li>
                                                    <li>
                                <span><a href="Teachers-platform---Technical-view_4751361.html">Teachers platform - Technical view</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Gobee : Download to PDF
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Hugo Plissonneau</span>, last modified by <span class='editor'> Nicolas Bern√®s</span> on Aug 24, 2022
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <style type="text/css">/*<![CDATA[*/
div.rbtoc1709200793726 {padding: 0px;}
div.rbtoc1709200793726 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1709200793726 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class="toc-macro rbtoc1709200793726"><style>[data-colorid=ea0kfjmyhp]{color:#6554c0} html[data-color-mode=dark] [data-colorid=ea0kfjmyhp]{color:#503fab}[data-colorid=wbmn4aylsy]{color:#6554c0} html[data-color-mode=dark] [data-colorid=wbmn4aylsy]{color:#503fab}[data-colorid=fw64bn1zs2]{color:#97a0af} html[data-color-mode=dark] [data-colorid=fw64bn1zs2]{color:#505968}[data-colorid=usuztcor35]{color:#6554c0} html[data-color-mode=dark] [data-colorid=usuztcor35]{color:#503fab}[data-colorid=tcqa7tcl65]{color:#4c9aff} html[data-color-mode=dark] [data-colorid=tcqa7tcl65]{color:#004eb3}[data-colorid=sqfeyu3dry]{color:#97a0af} html[data-color-mode=dark] [data-colorid=sqfeyu3dry]{color:#505968}[data-colorid=rl4ukqr6q6]{color:#4c9aff} html[data-color-mode=dark] [data-colorid=rl4ukqr6q6]{color:#004eb3}[data-colorid=v9rcpdv1rk]{color:#6554c0} html[data-color-mode=dark] [data-colorid=v9rcpdv1rk]{color:#503fab}[data-colorid=hfbdljrnzt]{color:#97a0af} html[data-color-mode=dark] [data-colorid=hfbdljrnzt]{color:#505968}[data-colorid=l388et8tgy]{color:#6554c0} html[data-color-mode=dark] [data-colorid=l388et8tgy]{color:#503fab}[data-colorid=kgr7qsonvk]{color:#4c9aff} html[data-color-mode=dark] [data-colorid=kgr7qsonvk]{color:#004eb3}[data-colorid=tfwbt7v6um]{color:#6554c0} html[data-color-mode=dark] [data-colorid=tfwbt7v6um]{color:#503fab}</style>
<ul class="toc-indentation">
<li><a href="#DownloadtoPDF-Overview">Overview</a></li>
<li><a href="#DownloadtoPDF-Frontend">Frontend</a>
<ul class="toc-indentation">
<li><a href="#DownloadtoPDF-Location">Location</a></li>
<li><a href="#DownloadtoPDF-DownloadingaPDFreport">Downloading a PDF report</a></li>
</ul>
</li>
<li><a href="#DownloadtoPDF-Backend">Backend</a>
<ul class="toc-indentation">
<li><a href="#DownloadtoPDF-Location.1">Location</a></li>
<li><a href="#DownloadtoPDF-Dependencies">Dependencies</a></li>
<li><a href="#DownloadtoPDF-Availableendpoints">Available endpoints</a></li>
<li><a href="#DownloadtoPDF-AddinganewPDFreportendpoint">Adding a new PDF report endpoint</a>
<ul class="toc-indentation">
<li><a href="#DownloadtoPDF-Addingtheendpoint">Adding the endpoint</a></li>
<li><a href="#DownloadtoPDF-GeneratingthePDFreport">Generating the PDF report</a>
<ul class="toc-indentation">
<li><a href="#DownloadtoPDF-PDFBuilder">PDFBuilder</a></li>
<li><a href="#DownloadtoPDF-PDFreportclasses">PDF report classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div><h1 id="DownloadtoPDF-Overview">Overview</h1><p>The PDF download feature enables users to download PDF reports of specific data.</p><p>To implement a new type of PDF report, refer to the diagram below and the subsequent information:</p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="attachments/4161699/16154629.png" data-image-src="attachments/4161699/16154629.png" data-height="890" data-width="1719" data-unresolved-comment-count="0" data-linked-resource-id="16154629" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="downloadpdf_sequence-20220824-130556.png" data-base-url="https://warchild-gobee.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="4161699" data-linked-resource-container-version="5" data-media-id="34f78fa5-ee9f-4113-8949-436b02f8e79a" data-media-type="file" /></span><h1 id="DownloadtoPDF-Frontend">Frontend</h1><h2 id="DownloadtoPDF-Location">Location</h2><div id="expander-2069162737" class="expand-container"><div id="expander-control-2069162737" class="expand-control"><span class="expand-control-icon"><img style="vertical-align:middle;" class="expand-control-image" src="images/icons/grey_arrow_down.png"/></span><span class="expand-control-text">Assessment</span></div><div id="expander-content-2069162737" class="expand-content"><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="attachments/4161699/7897089.png" data-image-src="attachments/4161699/7897089.png" data-height="325" data-width="1677" data-unresolved-comment-count="0" data-linked-resource-id="7897089" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20220718-082532.png" data-base-url="https://warchild-gobee.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="4161699" data-linked-resource-container-version="5" data-media-id="34ab3773-4bc2-42a6-b1cb-6cd0ee97c751" data-media-type="file" /></span><div class="table-wrap"><table data-layout="default" data-local-id="b44d18db-4987-4045-ab5f-9f7bc9ce02f8" class="confluenceTable"><colgroup><col style="width: 249.0px;" /><col style="width: 509.0px;" /></colgroup><tbody><tr><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p><strong>Page</strong></p></td><td class="confluenceTd"><p><strong>Assessment Builder</strong></p><ul><li><p>URL: <code>/assessment-builder/&lt;assessment_type&gt;</code></p></li></ul></td></tr><tr><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p><strong>Component</strong></p></td><td class="confluenceTd"><p><strong>AssessmentSummaryComponent</strong></p><ul><li><p>path: <code>src/app/assessment-builder/assessment-summary</code></p></li></ul></td></tr><tr><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p><strong>Downloading PDF through</strong></p></td><td class="confluenceTd"><p><strong>AssessmentService.</strong><span data-colorid="rl4ukqr6q6">downloadPDF</span></p><ul><li><p>path: <code>src/app/core/services/assessment.service.ts</code></p></li></ul></td></tr></tbody></table></div></div></div><div id="expander-1228024585" class="expand-container"><div id="expander-control-1228024585" class="expand-control"><span class="expand-control-icon"><img style="vertical-align:middle;" class="expand-control-image" src="images/icons/grey_arrow_down.png"/></span><span class="expand-control-text">Topic</span></div><div id="expander-content-1228024585" class="expand-content"><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="attachments/4161699/8159233.png" data-image-src="attachments/4161699/8159233.png" data-height="180" data-width="1172" data-unresolved-comment-count="0" data-linked-resource-id="8159233" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20220718-084739.png" data-base-url="https://warchild-gobee.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="4161699" data-linked-resource-container-version="5" data-media-id="92f78931-b8ba-4c70-b231-94381ea03b2f" data-media-type="file" /></span><div class="table-wrap"><table data-layout="default" data-local-id="240a8ecd-8a1d-400e-9359-7930aa408d7b" class="confluenceTable"><colgroup><col style="width: 250.0px;" /><col style="width: 508.0px;" /></colgroup><tbody><tr><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p><strong>Page</strong></p></td><td class="confluenceTd"><p><strong>Assessment Builder / Question</strong></p><ul><li><p>URL: <code>/assessment-builder/&lt;assessment_type&gt;/&lt;assessment_id&gt;/topic/&lt;topic_id&gt;</code></p></li></ul></td></tr><tr><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p><strong>Component</strong></p></td><td class="confluenceTd"><p><strong>TopicDetailsComponent</strong></p><ul><li><p>path: <code>src/app/assessment-builder/topic-details</code></p></li></ul></td></tr><tr><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p><strong>Downloading PDF through</strong></p></td><td class="confluenceTd"><p><strong>AssessmentService.</strong><span data-colorid="kgr7qsonvk">downloadPDF</span></p><ul><li><p>path: <code>src/app/core/services/assessment.service.ts</code></p></li></ul></td></tr></tbody></table></div></div></div><div id="expander-736274015" class="expand-container"><div id="expander-control-736274015" class="expand-control"><span class="expand-control-icon"><img style="vertical-align:middle;" class="expand-control-image" src="images/icons/grey_arrow_down.png"/></span><span class="expand-control-text">Question</span></div><div id="expander-content-736274015" class="expand-content"><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="attachments/4161699/8159239.png" data-image-src="attachments/4161699/8159239.png" data-height="164" data-width="1060" data-unresolved-comment-count="0" data-linked-resource-id="8159239" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20220718-090029.png" data-base-url="https://warchild-gobee.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="4161699" data-linked-resource-container-version="5" data-media-id="9952793a-b611-4b33-89dd-90269620ccee" data-media-type="file" /></span><div class="table-wrap"><table data-layout="default" data-local-id="b830eb2f-6bce-4cf1-958a-3dc299cb39e3" class="confluenceTable"><colgroup><col style="width: 250.0px;" /><col style="width: 508.0px;" /></colgroup><tbody><tr><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p><strong>Page</strong></p></td><td class="confluenceTd"><p><strong>Assessment Builder / Question</strong></p><ul><li><p>URL: <code>/assessment-builder/&lt;assessment_type&gt;/&lt;assessment_id&gt;/topic/&lt;topic_id&gt;</code></p></li></ul></td></tr><tr><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p><strong>Component</strong></p></td><td class="confluenceTd"><p><strong>TopicDetailsComponent</strong></p><ul><li><p>path: <code>src/app/assessment-builder/topic-details</code></p></li></ul></td></tr><tr><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p><strong>Downloading PDF through</strong></p></td><td class="confluenceTd"><p><strong>AssessmentService.</strong><span data-colorid="tcqa7tcl65">downloadPDF</span></p><ul><li><p>path: <code>src/app/core/services/assessment.service.ts</code></p></li></ul></td></tr></tbody></table></div></div></div><h2 id="DownloadtoPDF-DownloadingaPDFreport">Downloading a PDF report</h2><p>One way to fetch PDF data is to use a <a class="external-link" href="https://developer.mozilla.org/fr/docs/Web/API/Blob" rel="nofollow">Blob</a>:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">    HttpClient.get(pdfReportUrl, {
        responseType: 'blob', observe: 'response'
    }).subscribe((pdfRes: HttpResponse&lt;Blob&gt;) =&gt; { 
      // open the PDF document obtained for download
      ...
    });</pre>
</div></div><div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" /><div class="confluence-information-macro-body"><p><code>observe: 'response'</code> enables you to get API response headers on top of their content.</p><p>Without it you won&rsquo;t be able to receive the PDF file name if specified in the API response.</p></div></div><p>You can then open the PDF document in another window, where the users will be able to download it:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">const filename = pdfRes.headers.get('Content-Disposition').match(/(?:filename=&quot;)(.*)(?:&quot;{1})/)[1];
const url = window.URL.createObjectURL(pdfRes.body);
const w = window.open();
w.document.write(
  `&lt;html&gt;
    &lt;head&gt;
      &lt;title&gt;${filename}&lt;/title&gt;
    &lt;/head&gt;
    &lt;body style=&quot;margin: 0; padding: 0&quot;&gt;
      &lt;iframe src=&quot;${url}&quot; style=&quot;width: 100%; height: 100%; margin: 0; padding: 0; border: none;&quot;&gt;&lt;/iframe&gt;
    &lt;/body&gt;
  &lt;/html&gt;`
);</pre>
</div></div><p>Here overriding the HTML of the newly opened window via <code>w.document.write</code> to set a <code>&lt;title&gt;</code> tag is necessary if you want the file name to be displayed.</p><h1 id="DownloadtoPDF-Backend"><br />Backend</h1><h2 id="DownloadtoPDF-Location.1">Location</h2><p>The feature can be found in the <code>export</code> directory.</p><p>PDF template logic is located in <code>export/utils/reports.py</code>.</p><h2 id="DownloadtoPDF-Dependencies">Dependencies</h2><ul><li><p><strong>ReportLab PDF Toolkit</strong>, an open-source python library, is used to generate PDF templates.</p><ul><li><p><a class="external-link" href="https://docs.reportlab.com/reportlab/userguide/ch1_intro/" rel="nofollow">Documentation</a></p></li><li><p><a class="external-link" href="https://github.com/Distrotech/reportlab" rel="nofollow">Source code</a></p></li></ul></li><li><p><a class="external-link" data-card-appearance="inline" href="https://pypi.org/project/svglib/" rel="nofollow">https://pypi.org/project/svglib/</a> is used to embed vector images in pdf reports.</p></li></ul><h2 id="DownloadtoPDF-Availableendpoints">Available endpoints</h2><div class="table-wrap"><table data-layout="default" data-local-id="681e1d89-992f-42a0-88e3-d614afea91c4" class="confluenceTable"><colgroup><col style="width: 170.0px;" /><col style="width: 140.0px;" /><col style="width: 450.0px;" /></colgroup><tbody><tr><th data-highlight-colour="#f4f5f7" rowspan="2" class="confluenceTh"><p><strong>Assessment PDF report</strong></p></th><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p>URL</p></td><td data-highlight-colour="#ffffff" class="confluenceTd"><p><code>/export/assessments/&lt;assessment_id&gt;</code></p></td></tr><tr><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p>Viewset</p></td><td data-highlight-colour="#ffffff" class="confluenceTd"><p>export.views.<strong>AssessmentReportViewSet</strong></p></td></tr><tr><th data-highlight-colour="#f4f5f7" rowspan="2" class="confluenceTh"><p><strong>Topic PDF report</strong></p></th><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p>URL</p></td><td class="confluenceTd"><p><code>/export/assessments/&lt;assessment_id&gt;/topics/&lt;topic_id&gt;</code></p></td></tr><tr><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p>Viewset</p></td><td class="confluenceTd"><p>export.views.<strong>AssessmentTopicReportViewSet</strong></p></td></tr><tr><th data-highlight-colour="#f4f5f7" rowspan="2" class="confluenceTh"><p><strong>Question PDF report</strong></p></th><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p>URL</p></td><td class="confluenceTd"><p><code>/export/assessments/&lt;assessment_id&gt;/topics/&lt;topic_id&gt;/questions/&lt;question_id&gt;</code></p></td></tr><tr><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p>Viewset</p></td><td class="confluenceTd"><p>export.views.<strong>QuestionReportViewSet</strong></p></td></tr></tbody></table></div><h2 id="DownloadtoPDF-AddinganewPDFreportendpoint">Adding a new PDF report endpoint</h2><h3 id="DownloadtoPDF-Addingtheendpoint">Adding the endpoint</h3><ul><li><p>Add a new URL to <code>export/urls.py</code> and the corresponding Viewset in <code>export/viewsets.py</code> </p></li><li><p>From the exposed method of the Viewset (e.g. <code>list</code> or <code>retrieve</code>), do the following:</p><ul><li><p>Retrieve the data you wish to see in the generated PDF, and collect all the serialized results into a nested Dictionary, such that it represents the nested relationships accurately.</p></li></ul></li></ul><p><span data-colorid="hfbdljrnzt"><sub>Example of a nested dictionary for an assessment PDF report:</sub></span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">{
    'assessments': {
          ...
          'topics': [
              {
                  ...
                  'questions': [
                      { 
                        ... 
                      },
                      ...
                  ]
              },
              ...
          ],
      }
}</pre>
</div></div><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon" /><div class="confluence-information-macro-body"><p>The keys defined for nested data in the dictionnary will be later used to map their data to specifc PDF draw methods</p></div></div><ul><li><p>Generate the report (explained in the next section)</p></li><li><p>Return the obtained <code>BytesIO</code> result as a <code>FileResponse</code> object</p></li></ul><div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" /><div class="confluence-information-macro-body"><p>If you specify a file name in the <code>FileResponse</code>'s constructor, make sure to set the response&rsquo;s <code>Access-Control-Expose-Headers</code> to <code>Content-Disposition</code> . Without that, the file name won&rsquo;t be made accessible to the frontend.</p></div></div><h3 id="DownloadtoPDF-GeneratingthePDFreport">Generating the PDF report</h3><p><span data-colorid="sqfeyu3dry"><sub>General example (from the Viewset)</sub></span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: py; gutter: false; theme: Confluence" data-theme="Confluence"># Instantiate a PDF report class, subclass of PDFBuilder
builder = AssessmentPDFReport()

# Generate the PDF layout
builder.write_nested_data('assessments', assessment_data)

# Build the PDF and retrieve it as a BytesIO buffer
doc = builder.build()</pre>
</div></div><p /><h4 id="DownloadtoPDF-PDFBuilder">PDFBuilder</h4><p>The <code>PDFBuilder</code> class is in charge of mapping data to the appropriate draw method, as well as building the PDF object itself. </p><p>It must be inherited by all specific PDF report classes, and provides several methods:</p><div class="table-wrap"><table data-layout="default" data-local-id="ffb35782-2a6b-44c1-8f3a-bc03a76b989f" class="confluenceTable"><colgroup><col style="width: 680.0px;" /></colgroup><tbody><tr><th class="confluenceTh"><p>PDFBuilder.<strong>write_nested_data</strong>(<em>category: <span data-colorid="usuztcor35">str</span>, data: <span data-colorid="tfwbt7v6um">dict</span>, depth_level=0</em>) -&gt; <em><span data-colorid="wbmn4aylsy">None</span></em> </p></th></tr><tr><td class="confluenceTd"><p>Must be called to generate the PDF template.</p><p>Iterates recursively through the provided <code>data</code> dictionary, and calls the appropriate draw methods of the PDFBuilder subclass.</p><ul><li><p>For each iteration (meaning at each <code>depth_level</code>),  <code>category</code> represents the key for which a draw method must be called. It usually represents a nested relationship that we appended to data that was fetched from the database.<br /><span data-colorid="fw64bn1zs2">For instance, using the example defined above in &ldquo;Adding the endpoint&rdquo;; at depth_level=0, it must be &lsquo;assessments&rsquo;. at depth_level=2, category will be &lsquo;questions&rsquo;. </span></p></li><li><p>Categories must be defined by the subclass, through a <strong>write_handlers</strong> dictionnary, in which they will be keys mapped to specific draw methods of the subclass (this is explained further in &ldquo;PDF report classes&rdquo;). At the moment, there can be only one category per nesting level.</p></li></ul></td></tr></tbody></table></div><div class="table-wrap"><table data-layout="default" data-local-id="3bef4c8c-098c-4f95-b3b3-8f858fb23c2d" class="confluenceTable"><colgroup><col style="width: 680.0px;" /></colgroup><tbody><tr><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p>PDFBuilder.<strong>build</strong>() &rarr; <em><span data-colorid="v9rcpdv1rk">BytesIO</span></em></p></td></tr><tr><td class="confluenceTd"><p>Can be called after <code>write_nested_data</code> to get the generated PDF.</p><p>Builds the PDF with the elements added by the subclass to <code>PDFBuilder._story</code> , and returns it as a <code>BytesIO</code> buffer.</p></td></tr></tbody></table></div><div class="table-wrap"><table data-layout="default" data-local-id="9eb90ce5-5a5d-4981-b8cc-a9841515b1ef" class="confluenceTable"><colgroup><col style="width: 680.0px;" /></colgroup><tbody><tr><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p>PDFBuilder.<strong>_get_sized_image</strong>(<em>url: <span data-colorid="l388et8tgy">str</span>, size=cm</em>) -&gt; <em><span data-colorid="ea0kfjmyhp">Union[Image, Drawing]</span></em>:</p></td></tr><tr><td class="confluenceTd"><p>Can be used by PDFBuilder subclasses.</p><p>Returns an <code>Image</code> or <code>Drawing</code> object corresponding to the image specified at <code>url</code>, scaled to the specified <code>size</code>.</p></td></tr></tbody></table></div><div class="panel" style="background-color: #EAE6FF;border-color: #998DD9;border-width: 1px;"><div class="panelContent" style="background-color: #EAE6FF;">
<p>Padding and indentation related to depth level are handled by PDFBuilder automatically. If you need different ones for specific PDF reports you would need to override <code>PDFBuilder. __add_spacer</code> and <code>PDFBuilder.__remove_indentation</code></p>
</div></div><p /><h4 id="DownloadtoPDF-PDFreportclasses">PDF report classes</h4><p>PDF report classes must inherit <code>PDFBuilder</code> and only need to implement methods to write specific data onto the PDF document.</p><div class="table-wrap"><table data-layout="default" data-local-id="b56e9889-3362-4b4a-b771-ddbf337f8d11" class="confluenceTable"><colgroup><col style="width: 146.0px;" /><col style="width: 612.0px;" /></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Attributes</strong></p></th><th data-highlight-colour="#ffffff" class="confluenceTh"><p>All PDFBuilder subclasses must have the attribute <code>write_handlers</code> , to map each key of interest in nested data to a method that draws its data onto the PDF document.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: py; gutter: false; theme: Confluence" data-theme="Confluence">class AssessmentPDFReport(PDFBuilder):
      
      def __init__(self):
            super().__init__()

            # Define methods that will be called by write_nested_data
            # (keys must correspond to keys in serialized data, associated to a dict or list)
            self.write_handlers = {
                  'assessments': self.__write_assessment,
                  'topics': self.__write_topic,
                  'questions': self.__write_question
            }</pre>
</div></div></th></tr><tr><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p><strong>Methods</strong></p></td><td class="confluenceTd"><p>Every <code>write_handlers</code> method must implement the following signature:</p><p><code>&lt;method_name&gt;(self, data: dict) -&gt; None</code></p><p>To write onto the PDF document, they need to append their reportlab generated elements to <code>PDFBuilder._story</code> .</p></td></tr></tbody></table></div><p />
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/4161699/7897089.png">image-20220718-082532.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/4161699/7766021.png">image-20220718-084641.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/4161699/8159233.png">image-20220718-084739.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/4161699/8159239.png">image-20220718-090029.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/4161699/16842753.svg">downloadpdf_sequence-20220824-130044.svg</a> (image/svg+xml)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/4161699/16154629.png">downloadpdf_sequence-20220824-130556.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Feb 29, 2024 09:59</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
